clc
mysql( 'open', 'BDKPTL03', 'traders', 'kapitalo' );

%insert tradedays from now
bvsp_str_holidays = {...
    %2012
    '2012-01-25',...
    '2012-02-20','2012-02-21',...
    '2012-04-06',...
    '2012-05-01',...
    '2012-06-07',...
    '2012-07-09',...
    '2012-09-07',...
    '2012-10-12',...
    '2012-11-02','2012-11-15','2012-11-20',...
    '2012-12-24','2012-12-25','2012-12-31',...
    '2013-01-01','2013-01-25',...
    '2013-02-11','2013-02-12',...
    '2013-03-29',...
    '2013-05-01','2013-05-30',...
    '2013-07-09',...
    '2013-11-15','2013-11-20',...
    '2013-12-24','2013-12-25','2013-12-31',...
    '2014-01-01',...
    '2014-03-03','2014-03-04',...
    '2014-04-18','2014-04-21',...
    '2014-05-01',...
    '2014-06-19',...
    '2014-07-09',...
    '2014-11-20',...
    '2014-12-24','2014-12-25','2014-12-31',...
    '2015-01-01',...
    '2015-02-16','2015-02-17',...
    '2015-04-03','2015-04-21',...
    '2015-05-01',...
    '2015-06-04',...
    '2015-07-09',...
    '2015-09-07',...
    '2015-10-12',...
    '2015-11-02','2015-11-20',...
    '2015-12-24','2015-12-25','2015-12-31',...
    '2016-01-01','2016-01-25',...
    '2016-02-08','2016-02-09',...
    '2016-03-25',...
    '2016-04-21',...
    '2016-05-26',...
    '2016-09-07',...
    '2016-10-12',...
    '2016-11-02','2016-11-15',...
    '2016-12-30'};

for d = 1:length(bvsp_str_holidays)
    bvsp_holidays(d) = datenum(bvsp_str_holidays{d});
end

query_prefix = ['INSERT IGNORE into dbconfig.tradedates (t_tradedate) ',...
                'VALUES '];
today = datenum(2012,01,01);
enddate = datenum(2017,01,01);
while today < enddate
    today_vec = datevec(today);
    today_vec(4:6) = 0;
    today = datenum(today_vec);
    wday = weekday(today);
    if wday~=1 && wday~=7 && ~any(today == bvsp_holidays)
        serie_date = sprintf(' (''%s'')',datestr(today,'yyyy-mm-dd'));
        disp(serie_date);
        query = strcat(query_prefix,serie_date);
        [ lines ] = mysql(query);
    end
    today = addtodate(today,1,'day');
end
mysql('close')